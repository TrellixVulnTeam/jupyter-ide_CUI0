(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[7158],{37158:(e,t,s)=>{"use strict";s.r(t);s.d(t,{Debugger:()=>Be,IDebugger:()=>je,IDebuggerConfig:()=>Le,IDebuggerSidebar:()=>Ve,IDebuggerSources:()=>He});var i=s(92481);var n=s(83875);var r=s(75138);const o="jp-DebuggerEditor-highlight";const a=1e3;class d{constructor(e){var t,s,i,r;this._onGutterClick=(e,t)=>{var s,i,n;const r=e.lineInfo(t);if(!r||this._id!==((i=(s=this._debuggerService.session)===null||s===void 0?void 0:s.connection)===null||i===void 0?void 0:i.id)){return}const o=!!r.gutterMarkers;let a=this._getBreakpoints();if(o){a=a.filter((e=>e.line!==r.line+1))}else{a.push(l.createBreakpoint((n=this._path)!==null&&n!==void 0?n:this._debuggerService.session.connection.name,r.line+1))}void this._debuggerService.updateBreakpoints(this._editor.model.value.text,a,this._path)};this._id=(i=(s=(t=e.debuggerService.session)===null||t===void 0?void 0:t.connection)===null||s===void 0?void 0:s.id)!==null&&i!==void 0?i:"";this._path=(r=e.path)!==null&&r!==void 0?r:"";this._debuggerService=e.debuggerService;this._editor=e.editor;this._editorMonitor=new n.ActivityMonitor({signal:this._editor.model.value.changed,timeout:a});this._editorMonitor.activityStopped.connect((()=>{this._sendEditorBreakpoints()}),this);this._debuggerService.model.breakpoints.changed.connect((async()=>{if(!this._editor||this._editor.isDisposed){return}this._addBreakpointsToEditor()}));this._debuggerService.model.breakpoints.restored.connect((async()=>{if(!this._editor||this._editor.isDisposed){return}this._addBreakpointsToEditor()}));this._debuggerService.model.callstack.currentFrameChanged.connect((()=>{d.clearHighlight(this._editor)}));this._setupEditor()}dispose(){if(this.isDisposed){return}this._editorMonitor.dispose();this._clearEditor();this.isDisposed=true;r.Signal.clearData(this)}_setupEditor(){if(!this._editor||this._editor.isDisposed){return}this._addBreakpointsToEditor();const e=this._editor;e.setOption("lineNumbers",true);e.editor.setOption("gutters",["CodeMirror-linenumbers","breakpoints"]);e.editor.on("gutterClick",this._onGutterClick)}_clearEditor(){if(!this._editor||this._editor.isDisposed){return}const e=this._editor;d.clearHighlight(e);d.clearGutter(e);e.setOption("lineNumbers",false);e.editor.setOption("gutters",[]);e.editor.off("gutterClick",this._onGutterClick)}_sendEditorBreakpoints(){if(this._editor.isDisposed){return}const e=this._getBreakpointsFromEditor().map((e=>{var t,s;return l.createBreakpoint(((s=(t=this._debuggerService.session)===null||t===void 0?void 0:t.connection)===null||s===void 0?void 0:s.name)||"",e.line+1)}));void this._debuggerService.updateBreakpoints(this._editor.model.value.text,e,this._path)}_addBreakpointsToEditor(){var e,t;const s=this._editor;const i=this._getBreakpoints();if(this._id!==((t=(e=this._debuggerService.session)===null||e===void 0?void 0:e.connection)===null||t===void 0?void 0:t.id)){return}d.clearGutter(s);i.forEach((e=>{if(typeof e.line==="number"){s.editor.setGutterMarker(e.line-1,"breakpoints",l.createMarkerNode())}}))}_getBreakpointsFromEditor(){const e=this._editor;let t=[];for(let s=0;s<e.doc.lineCount();s++){const i=e.editor.lineInfo(s);if(i.gutterMarkers){t.push(i)}}return t}_getBreakpoints(){const e=this._editor.model.value.text;return this._debuggerService.model.breakpoints.getBreakpoints(this._path||this._debuggerService.getCodeId(e))}}(function(e){function t(e,t){s(e);const i=e;i.editor.addLineClass(t-1,"wrap",o);i.scrollIntoViewCentered({ch:0,line:t-1})}e.showCurrentLine=t;function s(e){if(!e||e.isDisposed){return}const t=e;t.doc.eachLine((e=>{t.editor.removeLineClass(e,"wrap",o)}))}e.clearHighlight=s;function i(e){if(!e){return}const t=e;t.doc.eachLine((e=>{if(e.gutterMarkers){t.editor.setGutterMarker(e,"breakpoints",null)}}))}e.clearGutter=i})(d||(d={}));var l;(function(e){function t(){const e=document.createElement("div");e.className="jp-DebuggerEditor-marker";e.innerHTML="●";return e}e.createMarkerNode=t;function s(e,t){return{line:t,verified:true,source:{name:e}}}e.createBreakpoint=s})(l||(l={}));const c=1540483477;const h=new TextEncoder;function u(e,t){const s=h.encode(e);let i=s.length;let n=t^i;let r=0;while(i>=4){let e=s[r]&255|(s[++r]&255)<<8|(s[++r]&255)<<16|(s[++r]&255)<<24;e=(e&65535)*c+(((e>>>16)*c&65535)<<16);e^=e>>>24;e=(e&65535)*c+(((e>>>16)*c&65535)<<16);n=(n&65535)*c+(((n>>>16)*c&65535)<<16)^e;i-=4;++r}switch(i){case 3:n^=(s[r+2]&255)<<16;case 2:n^=(s[r+1]&255)<<8;case 1:n^=s[r]&255;n=(n&65535)*c+(((n>>>16)*c&65535)<<16)}n^=n>>>13;n=(n&65535)*c+(((n>>>16)*c&65535)<<16);n^=n>>>15;return n>>>0}class g{constructor(){this._fileParams=new Map;this._hashMethods=new Map}getCodeId(e,t){const s=this._fileParams.get(t);if(!s){throw new Error(`Kernel (${t}) has no tmp file params.`)}const i=this._hashMethods.get(t);if(!i){throw new Error(`Kernel (${t}) has no hashing params.`)}const{prefix:n,suffix:r}=s;return`${n}${i(e)}${r}`}setHashParams(e){const{kernel:t,method:s,seed:i}=e;if(!t){throw new TypeError(`Kernel name is not defined.`)}switch(s){case"Murmur2":this._hashMethods.set(t,(e=>u(e,i).toString()));break;default:throw new Error(`Hash method (${s}) is not supported.`)}}setTmpFileParams(e){const{kernel:t,prefix:s,suffix:i}=e;if(!t){throw new TypeError(`Kernel name is not defined.`)}this._fileParams.set(t,{kernel:t,prefix:s,suffix:i})}getTmpFileParams(e){return this._fileParams.get(e)}}var p=s(26825);var _=s(6014);var v=s(61389);var m;(function(e){function t(e){const t=new b(Object.assign(Object.assign({},e),{body:new f(e),buttons:[p.Dialog.cancelButton({label:e.cancelLabel}),p.Dialog.okButton({label:e.okLabel})]}));return t.launch()}e.getCode=t})(m||(m={}));class b extends p.Dialog{handleEvent(e){if(e.type==="keydown"){const t=e;const{code:s,shiftKey:i}=t;if(i&&s==="Enter"){return this.resolve()}if(s==="Enter"){return}}super.handleEvent(e)}}class f extends v.Widget{constructor(e){super();const{rendermime:t,mimeType:s}=e;const i=new _.CodeCellModel({});i.mimeType=s!==null&&s!==void 0?s:"";this._prompt=new _.CodeCell({rendermime:t,model:i}).initializeState();this._prompt.inputArea.promptNode.remove();this.node.appendChild(this._prompt.node)}getValue(){return this._prompt.model.value.text}onAfterAttach(e){super.onAfterAttach(e);this._prompt.activate()}}var w=s(77616);class k{constructor(e){this._services=e.editorServices}createNewEditor(e){const{content:t,mimeType:s,path:i}=e;const n=this._services.factoryService.newInlineEditor;const r=this._services.mimeTypeService;const o=new w.CodeEditorWrapper({model:new w.CodeEditor.Model({value:t,mimeType:s||r.getMimeTypeByFilePath(i)}),factory:n,config:{readOnly:true,lineNumbers:true}});o.node.setAttribute("data-jp-debugger","true");return o}}var C=s(1612);var y=s(20702);var S=s(62867);class E{constructor(e){this._debuggerService=e.debuggerService;this._consolePanel=e.widget;this._cellMap=new y.ObservableMap;const t=this._consolePanel.console;if(t.promptCell){this._addEditorHandler(t.promptCell)}t.promptCellCreated.connect(((e,t)=>{this._addEditorHandler(t)}));const s=()=>{(0,S.each)(t.cells,(e=>this._addEditorHandler(e)))};s();this._consolePanel.console.cells.changed.connect(s)}dispose(){if(this.isDisposed){return}this.isDisposed=true;this._cellMap.values().forEach((e=>e.dispose()));this._cellMap.dispose();r.Signal.clearData(this)}_addEditorHandler(e){const t=e.model.id;if(e.model.type!=="code"||this._cellMap.has(t)){return}const s=e;const i=new d({debuggerService:this._debuggerService,editor:s.editor});s.disposed.connect((()=>{this._cellMap.delete(t);i.dispose()}));this._cellMap.set(t,i)}}class M{constructor(e){this._debuggerService=e.debuggerService;this._fileEditor=e.widget.content;this._editorHandler=new d({debuggerService:this._debuggerService,editor:this._fileEditor.editor})}dispose(){var e;if(this.isDisposed){return}this.isDisposed=true;(e=this._editorHandler)===null||e===void 0?void 0:e.dispose();r.Signal.clearData(this)}}class x{constructor(e){var t;this._debuggerService=e.debuggerService;this._notebookPanel=e.widget;this._cellMap=new y.ObservableMap;const s=this._notebookPanel.content;s.activeCellChanged.connect(this._onActiveCellChanged,this);(t=s.model)===null||t===void 0?void 0:t.cells.changed.connect(this._onCellsChanged,this);this._onCellsChanged()}dispose(){if(this.isDisposed){return}this.isDisposed=true;this._cellMap.values().forEach((e=>e.dispose()));this._cellMap.dispose();r.Signal.clearData(this)}_onCellsChanged(){this._notebookPanel.content.widgets.forEach((e=>this._addEditorHandler(e)))}_addEditorHandler(e){const t=e.model.id;if(e.model.type!=="code"||this._cellMap.has(t)){return}const s=e;const i=new d({debuggerService:this._debuggerService,editor:s.editor});s.disposed.connect((()=>{this._cellMap.delete(t);i.dispose()}));this._cellMap.set(e.model.id,i)}_onActiveCellChanged(e,t){if(this._notebookPanel.content!==e){return}this._addEditorHandler(t)}}const D="debugger-icon";function I(e,t,s,n,r=C.nullTranslator){const o=r.load("jupyterlab");const a=new p.ToolbarButton({className:"jp-DebuggerBugButton",icon:i.bugIcon,tooltip:o.__("Enable Debugger"),pressedIcon:i.bugDotIcon,pressedTooltip:o.__("Disable Debugger"),disabledTooltip:o.__("Select a kernel that supports debugging to enable debugger"),enabled:s,pressed:n,onClick:t});if(!e.toolbar.insertBefore("kernelName",D,a)){e.toolbar.addItem(D,a)}return a}function T(e,t,s=true,i){if(e){e.enabled=s;e.pressed=t;if(i){e.onClick=i}}}class B{constructor(e){this._handlers={};this._contextKernelChangedHandlers={};this._kernelChangedHandlers={};this._statusChangedHandlers={};this._iopubMessageHandlers={};this._iconButtons={};this._type=e.type;this._shell=e.shell;this._service=e.service}async update(e,t){if(!t){delete this._kernelChangedHandlers[e.id];delete this._statusChangedHandlers[e.id];delete this._iopubMessageHandlers[e.id];return this.updateWidget(e,t)}const s=()=>{void this.updateWidget(e,t)};const i=this._kernelChangedHandlers[e.id];if(i){t.kernelChanged.disconnect(i)}this._kernelChangedHandlers[e.id]=s;t.kernelChanged.connect(s);const n=(s,i)=>{if(i.endsWith("restarting")){void this.updateWidget(e,t)}};const r=this._statusChangedHandlers[e.id];if(r){t.statusChanged.disconnect(r)}t.statusChanged.connect(n);this._statusChangedHandlers[e.id]=n;const o=(e,t)=>{if(t.parent_header!={}&&t.parent_header.msg_type=="execute_request"&&this._service.isStarted&&!this._service.hasStoppedThreads()){void this._service.displayDefinedVariables()}};const a=this._iopubMessageHandlers[e.id];if(a){t.iopubMessage.disconnect(a)}t.iopubMessage.connect(o);this._iopubMessageHandlers[e.id]=o;return this.updateWidget(e,t)}async updateContext(e,t){const s=()=>{const{session:s}=t;void this.update(e,s)};const i=this._contextKernelChangedHandlers[e.id];if(i){t.kernelChanged.disconnect(i)}this._contextKernelChangedHandlers[e.id]=s;t.kernelChanged.connect(s);return this.update(e,t.session)}async updateWidget(e,t){var s,i;if(!this._service.model||!t){return}const n=()=>this._shell.currentWidget===e;const r=()=>{if(!this._handlers[e.id]){e.node.removeAttribute("data-jp-debugger");return}e.node.setAttribute("data-jp-debugger","true")};const o=()=>{if(this._handlers[e.id]){return}switch(this._type){case"notebook":this._handlers[e.id]=new x({debuggerService:this._service,widget:e});break;case"console":this._handlers[e.id]=new E({debuggerService:this._service,widget:e});break;case"file":this._handlers[e.id]=new M({debuggerService:this._service,widget:e});break;default:throw Error(`No handler for the type ${this._type}`)}r()};const a=()=>{var s,i,n,o;const a=this._handlers[e.id];if(!a){return}a.dispose();delete this._handlers[e.id];delete this._kernelChangedHandlers[e.id];delete this._statusChangedHandlers[e.id];delete this._iopubMessageHandlers[e.id];delete this._contextKernelChangedHandlers[e.id];if(((i=(s=this._service.session)===null||s===void 0?void 0:s.connection)===null||i===void 0?void 0:i.path)===(t===null||t===void 0?void 0:t.path)||!((o=(n=this._service.session)===null||n===void 0?void 0:n.connection)===null||o===void 0?void 0:o.kernel)){const e=this._service.model;e.clear()}r()};const d=(t=true)=>{const s=this._iconButtons[e.id];if(!s){this._iconButtons[e.id]=I(e,u,this._service.isStarted,t)}else{T(s,this._service.isStarted,t,u)}};const l=()=>{var e;return this._service.isStarted&&((e=this._previousConnection)===null||e===void 0?void 0:e.id)===(t===null||t===void 0?void 0:t.id)};const c=async()=>{this._service.session.connection=t;await this._service.stop()};const h=async()=>{this._service.session.connection=t;this._previousConnection=t;await this._service.restoreState(true);await this._service.displayDefinedVariables()};const u=async()=>{if(!n()){return}const t=this._iconButtons[e.id];if(l()){await c();a();T(t,false)}else{await h();o();T(t,true)}};d(false);const g=await this._service.isAvailable(t);if(!g){a();T(this._iconButtons[e.id],false,false);return}if(!this._service.session){this._service.session=new Be.Session({connection:t})}else{this._previousConnection=((s=this._service.session.connection)===null||s===void 0?void 0:s.kernel)?this._service.session.connection:null;this._service.session.connection=t}await this._service.restoreState(false);if(this._service.isStarted&&!this._service.hasStoppedThreads()){await this._service.displayDefinedVariables()}T(this._iconButtons[e.id],this._service.isStarted,true);if(!this._service.isStarted){a();this._service.session.connection=(i=this._previousConnection)!==null&&i!==void 0?i:t;await this._service.restoreState(false);return}o();this._previousConnection=t;e.disposed.connect(a)}}const j='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <g class="jp-icon3" fill="#616161">\n    <path d="M16.4805 17.2481C16.8158 16.3972 17 15.4701 17 14.5C17 10.3579 13.6421 7.00001 9.5 7.00001C8.36314 7.00001 7.28536 7.25295 6.31986 7.70564C7.60064 6.0592 9.60074 5 11.8482 5C15.7142 5 18.8482 8.13401 18.8482 12C18.8482 14.0897 17.9325 15.9655 16.4805 17.2481Z" />\n    <path d="M19.1607 14.2481C19.496 13.3971 19.6801 12.4701 19.6801 11.5C19.6801 7.35786 16.3223 4 12.1801 4C11.0433 4 9.9655 4.25295 9.00001 4.70563C10.2808 3.05919 12.2809 2 14.5284 2C18.3944 2 21.5284 5.134 21.5284 9C21.5284 11.0897 20.6127 12.9655 19.1607 14.2481Z" />\n    <path d="M16 15C16 18.866 12.866 22 9 22C5.13401 22 2 18.866 2 15C2 11.134 5.13401 8 9 8C12.866 8 16 11.134 16 15ZM11.7914 11L13 12.2086L10.2086 15L13 17.7914L11.7914 19L9 16.2086L6.20857 19L5 17.7914L7.79143 15L5 12.2086L6.20857 11L9 13.7914L11.7914 11Z" />\n    </g>\n</svg>\n';const L='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<g class="jp-icon3" fill="#616161">\n\t\t<path d="M7.99998 9.53198H8.54198L12.447 5.62698L11.386 4.56698L8.74898 7.17698L8.74898 0.999985H7.99998H7.25098L7.25098 7.17698L4.61398 4.56698L3.55298 5.62698L7.45798 9.53198H7.99998ZM9.95598 13.013C9.95598 14.1175 9.06055 15.013 7.95598 15.013C6.85141 15.013 5.95598 14.1175 5.95598 13.013C5.95598 11.9084 6.85141 11.013 7.95598 11.013C9.06055 11.013 9.95598 11.9084 9.95598 13.013Z"/>\n\t</g>\n</svg>\n';const H='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<g class="jp-icon3" fill="#616161">\n\t\t<path d="M7.99998 1H7.45798L3.55298 4.905L4.61398 5.965L7.25098 3.355V9.532H7.99998H8.74898V3.355L11.386 5.965L12.447 4.905L8.54198 1H7.99998ZM9.95598 13.013C9.95598 14.1176 9.06055 15.013 7.95598 15.013C6.85141 15.013 5.95598 14.1176 5.95598 13.013C5.95598 11.9084 6.85141 11.013 7.95598 11.013C9.06055 11.013 9.95598 11.9084 9.95598 13.013Z"/>\n\t</g>\n</svg>\n';const V='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<g class="jp-icon3" fill="#616161">\n\t\t<path d="M14.25 5.75V1.75H12.75V4.2916C11.605 2.93303 9.83899 2.08334 7.90914 2.08334C4.73316 2.08334 1.98941 4.39036 1.75072 7.48075L1.72992 7.75H3.231L3.25287 7.5241C3.46541 5.32932 5.45509 3.58334 7.90914 3.58334C9.6452 3.58334 11.1528 4.45925 11.9587 5.75H9.12986V7.25H13.292L14.2535 6.27493V5.75H14.25ZM7.99997 14C9.10454 14 9.99997 13.1046 9.99997 12C9.99997 10.8954 9.10454 10 7.99997 10C6.8954 10 5.99997 10.8954 5.99997 12C5.99997 13.1046 6.8954 14 7.99997 14Z"/>\n\t</g>\n</svg>\n';const R='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 4L1 4.5V12.5L1.5 13H4V12H2V5H4V4H1.5ZM14.5 13L15 12.5L15 4.5L14.5 4H12V5L14 5L14 12H12V13H14.5ZM8.79693 5L4.29693 7L4 7.45691V9.95691L4.24275 10.3857L6.74275 11.8857L7.20307 11.9138L11.7031 9.91381L12 9.45691V6.95691L11.7572 6.52816L9.25725 5.02816L8.79693 5ZM5 8.34V9.67381L6.5 10.5738V9.24L5 8.34ZM7.5 9.28184V10.6875L11 9.13197V7.72629L7.5 9.28184ZM10.4178 6.89071L8.96559 6.01936L5.58216 7.52311L7.03441 8.39445L10.4178 6.89071Z" fill="#007ACC"/>\n</svg>\n';const W='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n    <g class="jp-icon3" fill="#616161">\n        <path d="M5 2H15L20 7V20C20 20.5304 19.7893 21.0391 19.4142 21.4142C19.0391 21.7893 18.5304 22 18 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V14H4V16L8 13L4 10V12H3V4C3 3.46957 3.21071 2.96086 3.58579 2.58579C3.96086 2.21071 4.46957 2 5 2ZM12 18H16V16H12V18ZM12 14H18V12H12V14ZM12 10H18V8H12V10ZM10 14C10.5523 14 11 13.5523 11 13C11 12.4477 10.5523 12 10 12C9.44771 12 9 12.4477 9 13C9 13.5523 9.44771 14 10 14Z"/>\n        <path d="M3 12V14H1V13V12H3Z"/>\n    </g>\n</svg>\n';const F=new i.LabIcon({name:"debugger:close-all",svgstr:j});const P=new i.LabIcon({name:"debugger:step-into",svgstr:L});const N=new i.LabIcon({name:"debugger:step-over",svgstr:V});const q=new i.LabIcon({name:"debugger:step-out",svgstr:H});const A=new i.LabIcon({name:"debugger:variable",svgstr:R});const O=new i.LabIcon({name:"debugger:view-breakpoint",svgstr:W});class Z{constructor(){this._breakpoints=new Map;this._changed=new r.Signal(this);this._restored=new r.Signal(this);this._clicked=new r.Signal(this)}get changed(){return this._changed}get restored(){return this._restored}get clicked(){return this._clicked}get breakpoints(){return this._breakpoints}setBreakpoints(e,t){this._breakpoints.set(e,t);this._changed.emit(t)}getBreakpoints(e){var t;return(t=this._breakpoints.get(e))!==null&&t!==void 0?t:[]}restoreBreakpoints(e){this._breakpoints=e;this._restored.emit()}}class ${constructor(){this._state=[];this._framesChanged=new r.Signal(this);this._currentFrameChanged=new r.Signal(this)}get frames(){return this._state}set frames(e){this._state=e;const t=e.find((e=>z.getFrameId(e)===z.getFrameId(this.frame)));if(!t){this.frame=e[0]}this._framesChanged.emit(e)}get frame(){return this._currentFrame}set frame(e){this._currentFrame=e;this._currentFrameChanged.emit(e)}get framesChanged(){return this._framesChanged}get currentFrameChanged(){return this._currentFrameChanged}}var z;(function(e){function t(e){var t;return`${(t=e===null||e===void 0?void 0:e.source)===null||t===void 0?void 0:t.path}-${e===null||e===void 0?void 0:e.id}`}e.getFrameId=t})(z||(z={}));class G{constructor(e){this._currentSourceOpened=new r.Signal(this);this._currentSourceChanged=new r.Signal(this);this.currentFrameChanged=e.currentFrameChanged}get currentSourceOpened(){return this._currentSourceOpened}get currentSourceChanged(){return this._currentSourceChanged}get currentSource(){return this._currentSource}set currentSource(e){this._currentSource=e;this._currentSourceChanged.emit(e)}open(){this._currentSourceOpened.emit(this._currentSource)}}class K{constructor(){this._state=[];this._variableExpanded=new r.Signal(this);this._changed=new r.Signal(this)}get scopes(){return this._state}set scopes(e){this._state=e;this._changed.emit()}get changed(){return this._changed}get variableExpanded(){return this._variableExpanded}expandVariable(e){this._variableExpanded.emit(e)}}class U{constructor(){this._disposed=new r.Signal(this);this._isDisposed=false;this._stoppedThreads=new Set;this._title="-";this._titleChanged=new r.Signal(this);this.breakpoints=new Z;this.callstack=new $;this.variables=new K;this.sources=new G({currentFrameChanged:this.callstack.currentFrameChanged})}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get stoppedThreads(){return this._stoppedThreads}set stoppedThreads(e){this._stoppedThreads=e}get title(){return this._title}set title(e){if(e===this._title){return}this._title=e!==null&&e!==void 0?e:"-";this._titleChanged.emit(e)}get titleChanged(){return this._titleChanged}dispose(){if(this._isDisposed){return}this._isDisposed=true;this._disposed.emit()}clear(){this._stoppedThreads.clear();const e=new Map;this.breakpoints.restoreBreakpoints(e);this.callstack.frames=[];this.variables.scopes=[];this.sources.currentSource=null;this.title="-"}}var J=s(28921);class Q extends v.Panel{constructor(e){super();const{model:t,commands:s,themeManager:i,scopes:n}=e;this._grid=new X({commands:s,themeManager:i});this._grid.addClass("jp-DebuggerVariables-grid");this._model=t;this._model.changed.connect((e=>{this._update()}),this);this._grid.dataModel.setData(n!==null&&n!==void 0?n:[]);this.addWidget(this._grid);this.addClass("jp-DebuggerVariables-body")}set filter(e){this._grid.dataModel.filter=e;this._update()}set scope(e){this._grid.dataModel.scope=e;this._update()}_update(){var e;this._grid.dataModel.setData((e=this._model.scopes)!==null&&e!==void 0?e:[])}}class X extends v.Panel{constructor(e){super();const{commands:t,themeManager:s}=e;const i=new Y;const n=new J._$;const r=new ee.MouseHandler;r.doubleClicked.connect(((e,s)=>t.execute(Be.CommandIDs.inspectVariable,{variableReference:i.getVariableReference(s.row),title:i.getVariableName(s.row)})));n.dataModel=i;n.keyHandler=new J.Pl;n.mouseHandler=r;n.selectionModel=new J.T6({dataModel:i});n.stretchLastColumn=true;n.node.style.height="100%";this._grid=n;if(s){s.themeChanged.connect(this._updateStyles,this)}this.addWidget(n)}set filter(e){this._grid.dataModel.filter=e;this.update()}set scope(e){this._grid.dataModel.scope=e;this.update()}get dataModel(){return this._grid.dataModel}onAfterAttach(e){super.onAfterAttach(e);this._updateStyles()}_updateStyles(){const{style:e,textRenderer:t}=ee.computeStyle();this._grid.cellRenderers.update({},t);this._grid.style=e}}class Y extends J.vQ{constructor(){super(...arguments);this._filter=new Set;this._scope="";this._data={name:[],type:[],value:[],variablesReference:[]}}set filter(e){this._filter=e}get scope(){return this._scope}set scope(e){this._scope=e}rowCount(e){return e==="body"?this._data.name.length:1}columnCount(e){return e==="body"?2:1}data(e,t,s){if(e==="row-header"){return this._data.name[t]}if(e==="column-header"){return s===1?"Value":"Type"}if(e==="corner-header"){return"Name"}return s===1?this._data.value[t]:this._data.type[t]}getVariableReference(e){return this._data.variablesReference[e]}getVariableName(e){return this._data.name[e]}setData(e){var t,s;this._clearData();this.emitChanged({type:"model-reset",region:"body"});const i=(t=e.find((e=>e.name===this._scope)))!==null&&t!==void 0?t:e[0];const n=(s=i===null||i===void 0?void 0:i.variables)!==null&&s!==void 0?s:[];const r=n.filter((e=>e.name&&!this._filter.has(e.name)));r.forEach(((e,t)=>{var s;this._data.name[t]=e.name;this._data.type[t]=(s=e.type)!==null&&s!==void 0?s:"";this._data.value[t]=e.value;this._data.variablesReference[t]=e.variablesReference}));this.emitChanged({type:"rows-inserted",region:"body",index:1,span:r.length})}_clearData(){this._data={name:[],type:[],value:[],variablesReference:[]}}}var ee;(function(e){function t(){const e=document.createElement("div");e.className="jp-DebuggerVariables-colorPalette";e.innerHTML=`\n      <div class="jp-mod-void"></div>\n      <div class="jp-mod-background"></div>\n      <div class="jp-mod-header-background"></div>\n      <div class="jp-mod-grid-line"></div>\n      <div class="jp-mod-header-grid-line"></div>\n      <div class="jp-mod-selection"></div>\n      <div class="jp-mod-text"></div>\n    `;return e}function s(){const e=t();document.body.appendChild(e);let s;s=e.querySelector(".jp-mod-void");const i=getComputedStyle(s).color;s=e.querySelector(".jp-mod-background");const n=getComputedStyle(s).color;s=e.querySelector(".jp-mod-header-background");const r=getComputedStyle(s).color;s=e.querySelector(".jp-mod-grid-line");const o=getComputedStyle(s).color;s=e.querySelector(".jp-mod-header-grid-line");const a=getComputedStyle(s).color;s=e.querySelector(".jp-mod-selection");const d=getComputedStyle(s).color;s=e.querySelector(".jp-mod-text");const l=getComputedStyle(s).color;document.body.removeChild(e);return{style:{voidColor:i,backgroundColor:n,headerBackgroundColor:r,gridLineColor:o,headerGridLineColor:a,rowBackgroundColor:e=>e%2===0?i:n,selectionFillColor:d},textRenderer:new J.tV({font:"12px sans-serif",textColor:l,backgroundColor:"",verticalAlignment:"center",horizontalAlignment:"left"})}}e.computeStyle=s;class i extends J.dN{constructor(){super(...arguments);this._doubleClicked=new r.Signal(this)}get doubleClicked(){return this._doubleClicked}onMouseDoubleClick(e,t){const s=e.hitTest(t.clientX,t.clientY);this._doubleClicked.emit(s)}}e.MouseHandler=i})(ee||(ee={}));class te{constructor(e){var t,s;this._eventMessage=new r.Signal(this);this._isDisposed=false;this._sessionChanged=new r.Signal(this);this._config=e.config;this._session=null;this._specsManager=(t=e.specsManager)!==null&&t!==void 0?t:null;this._model=new Be.Model;this._debuggerSources=(s=e.debuggerSources)!==null&&s!==void 0?s:null}get eventMessage(){return this._eventMessage}get isDisposed(){return this._isDisposed}get isStarted(){var e,t;return(t=(e=this._session)===null||e===void 0?void 0:e.isStarted)!==null&&t!==void 0?t:false}get model(){return this._model}get session(){return this._session}set session(e){var t;if(this._session===e){return}if(this._session){this._session.dispose()}this._session=e;(t=this._session)===null||t===void 0?void 0:t.eventMessage.connect(((e,t)=>{if(t.event==="stopped"){this._model.stoppedThreads.add(t.body.threadId);void this._getAllFrames()}else if(t.event==="continued"){this._model.stoppedThreads.delete(t.body.threadId);this._clearModel();this._clearSignals()}this._eventMessage.emit(t)}));this._sessionChanged.emit(e)}get sessionChanged(){return this._sessionChanged}dispose(){if(this.isDisposed){return}this._isDisposed=true;r.Signal.clearData(this)}getCodeId(e){var t,s,i,n;try{return this._config.getCodeId(e,(n=(i=(s=(t=this.session)===null||t===void 0?void 0:t.connection)===null||s===void 0?void 0:s.kernel)===null||i===void 0?void 0:i.name)!==null&&n!==void 0?n:"")}catch(r){return""}}hasStoppedThreads(){var e,t;return(t=((e=this._model)===null||e===void 0?void 0:e.stoppedThreads.size)>0)!==null&&t!==void 0?t:false}async isAvailable(e){var t,s,i,n;if(!this._specsManager){return true}await this._specsManager.ready;const r=e===null||e===void 0?void 0:e.kernel;if(!r){return false}const o=r.name;if(!((t=this._specsManager.specs)===null||t===void 0?void 0:t.kernelspecs[o])){return true}return!!((n=(i=(s=this._specsManager.specs.kernelspecs[o])===null||s===void 0?void 0:s.metadata)===null||i===void 0?void 0:i["debugger"])!==null&&n!==void 0?n:false)}async clearBreakpoints(){var e;if(((e=this.session)===null||e===void 0?void 0:e.isStarted)!==true){return}this._model.breakpoints.breakpoints.forEach(((e,t,s)=>{void this._setBreakpoints([],t)}));let t=new Map;this._model.breakpoints.restoreBreakpoints(t)}async continue(){try{if(!this.session){throw new Error("No active debugger session")}await this.session.sendRequest("continue",{threadId:this._currentThread()});this._model.stoppedThreads.delete(this._currentThread());this._clearModel();this._clearSignals()}catch(e){console.error("Error:",e.message)}}async getSource(e){var t,s;if(!this.session){throw new Error("No active debugger session")}const i=await this.session.sendRequest("source",{source:e,sourceReference:(t=e.sourceReference)!==null&&t!==void 0?t:0});return Object.assign(Object.assign({},i.body),{path:(s=e.path)!==null&&s!==void 0?s:""})}async evaluate(e){var t;if(!this.session){throw new Error("No active debugger session")}const s=(t=this.model.callstack.frame)===null||t===void 0?void 0:t.id;const i=await this.session.sendRequest("evaluate",{context:"repl",expression:e,frameId:s});if(!i.success){return null}this._clearModel();await this._getAllFrames();return i.body}async next(){try{if(!this.session){throw new Error("No active debugger session")}await this.session.sendRequest("next",{threadId:this._currentThread()})}catch(e){console.error("Error:",e.message)}}async inspectVariable(e){if(!this.session){throw new Error("No active debugger session")}const t=await this.session.sendRequest("variables",{variablesReference:e});return t.body.variables}async displayDefinedVariables(){if(!this.session){throw new Error("No active debugger session")}const e=await this.session.sendRequest("inspectVariables",{});const t=e.body.variables;const s=[{name:"Globals",variables:t}];this._model.variables.scopes=s}async restart(){const{breakpoints:e}=this._model.breakpoints;await this.stop();await this.start();await this._restoreBreakpoints(e)}async restoreState(e){var t,s,i,n,r,o,a,d,l,c;if(!this.model||!this.session){return}const h=await this.session.restoreState();const{body:u}=h;const g=this._mapBreakpoints(h.body.breakpoints);const p=new Set(h.body.stoppedThreads);this._config.setHashParams({kernel:(n=(i=(s=(t=this.session)===null||t===void 0?void 0:t.connection)===null||s===void 0?void 0:s.kernel)===null||i===void 0?void 0:i.name)!==null&&n!==void 0?n:"",method:u.hashMethod,seed:u.hashSeed});this._config.setTmpFileParams({kernel:(d=(a=(o=(r=this.session)===null||r===void 0?void 0:r.connection)===null||o===void 0?void 0:o.kernel)===null||a===void 0?void 0:a.name)!==null&&d!==void 0?d:"",prefix:u.tmpFilePrefix,suffix:u.tmpFileSuffix});this._model.stoppedThreads=p;if(!this.isStarted&&(e||p.size!==0)){await this.start()}if(this.isStarted||e){this._model.title=this.isStarted?((c=(l=this.session)===null||l===void 0?void 0:l.connection)===null||c===void 0?void 0:c.name)||"-":"-"}if(this._debuggerSources){const e=this._filterBreakpoints(g);this._model.breakpoints.restoreBreakpoints(e)}else{this._model.breakpoints.restoreBreakpoints(g)}if(p.size!==0){await this._getAllFrames()}else if(this.isStarted){this._clearModel();this._clearSignals()}}start(){if(!this.session){throw new Error("No active debugger session")}return this.session.start()}async stepIn(){try{if(!this.session){throw new Error("No active debugger session")}await this.session.sendRequest("stepIn",{threadId:this._currentThread()})}catch(e){console.error("Error:",e.message)}}async stepOut(){try{if(!this.session){throw new Error("No active debugger session")}await this.session.sendRequest("stepOut",{threadId:this._currentThread()})}catch(e){console.error("Error:",e.message)}}async stop(){if(!this.session){throw new Error("No active debugger session")}await this.session.stop();if(this._model){this._model.clear()}}async updateBreakpoints(e,t,s){var i;if(!((i=this.session)===null||i===void 0?void 0:i.isStarted)){return}if(!s){s=(await this._dumpCell(e)).body.sourcePath}const n=await this.session.restoreState();const r=t.filter((({line:e})=>typeof e==="number")).map((({line:e})=>({line:e})));const o=this._mapBreakpoints(n.body.breakpoints);if(this._debuggerSources){const e=this._filterBreakpoints(o);this._model.breakpoints.restoreBreakpoints(e)}else{this._model.breakpoints.restoreBreakpoints(o)}const a=await this._setBreakpoints(r,s);const d=a.body.breakpoints.filter(((e,t,s)=>s.findIndex((t=>t.line===e.line))>-1));this._model.breakpoints.setBreakpoints(s,d);await this.session.sendRequest("configurationDone",{})}getDebuggerState(){var e,t,s,i,n,r,o;const a=this._model.breakpoints.breakpoints;let d=[];for(const l of a.keys()){const a=this._debuggerSources.find({focus:false,kernel:(i=(s=(t=(e=this.session)===null||e===void 0?void 0:e.connection)===null||t===void 0?void 0:t.kernel)===null||s===void 0?void 0:s.name)!==null&&i!==void 0?i:"",path:(o=(r=(n=this._session)===null||n===void 0?void 0:n.connection)===null||r===void 0?void 0:r.path)!==null&&o!==void 0?o:"",source:l});const c=a.map((e=>e.model.value.text));d=d.concat(c)}return{cells:d,breakpoints:a}}async restoreDebuggerState(e){var t,s,i,n;await this.start();for(const c of e.cells){await this._dumpCell(c)}const r=new Map;const o=(n=(i=(s=(t=this.session)===null||t===void 0?void 0:t.connection)===null||s===void 0?void 0:s.kernel)===null||i===void 0?void 0:i.name)!==null&&n!==void 0?n:"";const{prefix:a,suffix:d}=this._config.getTmpFileParams(o);for(const c of e.breakpoints){const[e,t]=c;const s=e.substr(0,e.length-d.length);const i=s.substr(s.lastIndexOf("/")+1);const n=a.concat(i).concat(d);r.set(n,t)}await this._restoreBreakpoints(r);const l=await this.session.sendRequest("configurationDone",{});await this.restoreState(false);return l.success}_clearModel(){this._model.callstack.frames=[];this._model.variables.scopes=[]}_clearSignals(){this._model.callstack.currentFrameChanged.disconnect(this._onCurrentFrameChanged,this);this._model.variables.variableExpanded.disconnect(this._onVariableExpanded,this)}_convertScopes(e,t){if(!t||!e){return[]}return e.map(((e,s)=>({name:e.name,variables:t[s].map((e=>Object.assign({},e)))})))}_currentThread(){return 1}async _dumpCell(e){if(!this.session){throw new Error("No active debugger session")}return this.session.sendRequest("dumpCell",{code:e})}_filterBreakpoints(e){if(!this._debuggerSources){return e}let t=new Map;for(const s of e){const[e,i]=s;i.forEach((()=>{var s,n,r,o,a,d,l;this._debuggerSources.find({focus:false,kernel:(o=(r=(n=(s=this.session)===null||s===void 0?void 0:s.connection)===null||n===void 0?void 0:n.kernel)===null||r===void 0?void 0:r.name)!==null&&o!==void 0?o:"",path:(l=(d=(a=this._session)===null||a===void 0?void 0:a.connection)===null||d===void 0?void 0:d.path)!==null&&l!==void 0?l:"",source:e}).forEach((()=>{if(i.length>0){t.set(e,i)}}))}))}return t}async _getAllFrames(){this._model.callstack.currentFrameChanged.connect(this._onCurrentFrameChanged,this);this._model.variables.variableExpanded.connect(this._onVariableExpanded,this);const e=await this._getFrames(this._currentThread());this._model.callstack.frames=e}async _getFrames(e){if(!this.session){throw new Error("No active debugger session")}const t=await this.session.sendRequest("stackTrace",{threadId:e});const s=t.body.stackFrames;return s}async _getScopes(e){if(!this.session){throw new Error("No active debugger session")}if(!e){return[]}const t=await this.session.sendRequest("scopes",{frameId:e.id});return t.body.scopes}async _getVariables(e){if(!this.session){throw new Error("No active debugger session")}if(!e){return[]}const t=await this.session.sendRequest("variables",{variablesReference:e.variablesReference});return t.body.variables}_mapBreakpoints(e){if(!e.length){return new Map}return e.reduce(((e,t)=>{const{breakpoints:s,source:i}=t;e.set(i,s.map((e=>Object.assign(Object.assign({},e),{source:{path:i},verified:true}))));return e}),new Map)}async _onCurrentFrameChanged(e,t){if(!t){return}const s=await this._getScopes(t);const i=await Promise.all(s.map((e=>this._getVariables(e))));const n=this._convertScopes(s,i);this._model.variables.scopes=n}async _onVariableExpanded(e,t){if(!this.session){throw new Error("No active debugger session")}const s=await this.session.sendRequest("variables",{variablesReference:t.variablesReference});let i=Object.assign(Object.assign({},t),{expanded:true});s.body.variables.forEach((e=>{i=Object.assign({[e.name]:e},i)}));const n=this._model.variables.scopes.map((e=>{const s=e.variables.findIndex((e=>e.variablesReference===t.variablesReference));e.variables[s]=i;return Object.assign({},e)}));this._model.variables.scopes=[...n];return s.body.variables}async _setBreakpoints(e,t){if(!this.session){throw new Error("No active debugger session")}return await this.session.sendRequest("setBreakpoints",{breakpoints:e,source:{path:t},sourceModified:false})}async _restoreBreakpoints(e){for(const[t,s]of e){console.log(t);await this._setBreakpoints(s.filter((({line:e})=>typeof e==="number")).map((({line:e})=>({line:e}))),t)}this._model.breakpoints.restoreBreakpoints(e)}}var se=s(9727);class ie{constructor(e){this._seq=0;this._ready=new se.PromiseDelegate;this._isDisposed=false;this._isStarted=false;this._disposed=new r.Signal(this);this._eventMessage=new r.Signal(this);this.connection=e.connection;this.translator=e.translator||C.nullTranslator}get isDisposed(){return this._isDisposed}get disposed(){return this._disposed}get connection(){return this._connection}set connection(e){var t,s;if(this._connection){this._connection.iopubMessage.disconnect(this._handleEvent,this)}this._connection=e;if(!this._connection){this._isStarted=false;return}this._connection.iopubMessage.connect(this._handleEvent,this);this._ready=new se.PromiseDelegate;const i=(s=(t=this.connection)===null||t===void 0?void 0:t.kernel)===null||s===void 0?void 0:s.requestDebug({type:"request",seq:0,command:"debugInfo"});if(i){i.onReply=e=>{this._ready.resolve();i.dispose()}}}get isStarted(){return this._isStarted}get eventMessage(){return this._eventMessage}dispose(){if(this._isDisposed){return}this._isDisposed=true;this._disposed.emit();r.Signal.clearData(this)}async start(){var e,t,s;const i=await this.sendRequest("initialize",{clientID:"jupyterlab",clientName:"JupyterLab",adapterID:(s=(t=(e=this.connection)===null||e===void 0?void 0:e.kernel)===null||t===void 0?void 0:t.name)!==null&&s!==void 0?s:"",pathFormat:"path",linesStartAt1:true,columnsStartAt1:true,supportsVariableType:true,supportsVariablePaging:true,supportsRunInTerminalRequest:true,locale:document.documentElement.lang});if(!i.success){throw new Error(`Could not start the debugger: ${i.message}`)}this._isStarted=true;await this.sendRequest("attach",{})}async stop(){await this.sendRequest("disconnect",{restart:false,terminateDebuggee:false});this._isStarted=false}async restoreState(){const e=await this.sendRequest("debugInfo",{});this._isStarted=e.body.isStarted;return e}async sendRequest(e,t){await this._ready.promise;const s=await this._sendDebugMessage({type:"request",seq:this._seq++,command:e,arguments:t});return s.content}_handleEvent(e,t){const s=t.header.msg_type;if(s!=="debug_event"){return}const i=t.content;this._eventMessage.emit(i)}async _sendDebugMessage(e){var t;const s=(t=this.connection)===null||t===void 0?void 0:t.kernel;if(!s){return Promise.reject(new Error("A kernel is required to send debug messages."))}const i=new se.PromiseDelegate;const n=s.requestDebug(e);n.onReply=e=>{i.resolve(e)};await n.done;return i.promise}}var ne=s(2411);var re=s.n(ne);class oe extends p.ReactWidget{constructor(e){super();this._model=e;this.addClass("jp-DebuggerBreakpoints-body")}render(){return re().createElement(ae,{model:this._model})}}const ae=({model:e})=>{const[t,s]=(0,ne.useState)(Array.from(e.breakpoints.entries()));(0,ne.useEffect)((()=>{const t=(t,i)=>{s(Array.from(e.breakpoints.entries()))};const i=t=>{s(Array.from(e.breakpoints.entries()))};e.changed.connect(t);e.restored.connect(i);return()=>{e.changed.disconnect(t);e.restored.disconnect(i)}}));return re().createElement(re().Fragment,null,t.map((t=>re().createElement(de,{key:t[0],breakpoints:t[1],model:e}))))};const de=({breakpoints:e,model:t})=>re().createElement(re().Fragment,null,e.sort(((e,t)=>{var s,i;return((s=e.line)!==null&&s!==void 0?s:0)-((i=t.line)!==null&&i!==void 0?i:0)})).map(((e,s)=>{var i,n;return re().createElement(le,{key:((n=(i=e.source)===null||i===void 0?void 0:i.path)!==null&&n!==void 0?n:"")+s,breakpoint:e,model:t})})));const le=({breakpoint:e,model:t})=>{var s,i,n;const r=e=>e[0]==="/"?e.slice(1)+"/":e;return re().createElement("div",{className:"jp-DebuggerBreakpoint",onClick:()=>t.clicked.emit(e),title:(s=e.source)===null||s===void 0?void 0:s.path},re().createElement("span",{className:"jp-DebuggerBreakpoint-marker"},"●"),re().createElement("span",{className:"jp-DebuggerBreakpoint-source jp-left-truncated"},r((n=(i=e.source)===null||i===void 0?void 0:i.path)!==null&&n!==void 0?n:"")),re().createElement("span",{className:"jp-DebuggerBreakpoint-line"},e.line))};class ce extends v.Widget{constructor(e){super({node:document.createElement("div")});this.toolbar=new p.Toolbar;this.node.classList.add("jp-stack-panel-header");e=e||C.nullTranslator;const t=e.load("jupyterlab");const s=new v.Widget({node:document.createElement("h2")});s.node.textContent=t.__("Breakpoints");const i=new v.PanelLayout;i.addWidget(s);i.addWidget(this.toolbar);this.layout=i}}class he extends v.Panel{constructor(e){super();this.clicked=new r.Signal(this);const{model:t,service:s}=e;const i=e.translator||C.nullTranslator;const n=i.load("jupyterlab");const o=new ce(i);const a=new oe(t);o.toolbar.addItem("closeAll",new p.ToolbarButton({icon:F,onClick:async()=>{if(t.breakpoints.size===0){return}const e=await(0,p.showDialog)({title:n.__("Remove All Breakpoints"),body:n.__("Are you sure you want to remove all breakpoints?"),buttons:[p.Dialog.okButton({label:n.__("Remove breakpoints")}),p.Dialog.cancelButton({label:n.__("Cancel")})],hasClose:true});if(e.button.accept){return s.clearBreakpoints()}},tooltip:n.__("Remove All Breakpoints")}));this.addWidget(o);this.addWidget(a);this.addClass("jp-DebuggerBreakpoints")}}class ue extends p.ReactWidget{constructor(e){super();this._model=e;this.addClass("jp-DebuggerCallstack-body")}render(){return re().createElement(ge,{model:this._model})}}const ge=({model:e})=>{const[t,s]=(0,ne.useState)(e.frames);const[i,r]=(0,ne.useState)(e.frame);const o=t=>{r(t);e.frame=t};(0,ne.useEffect)((()=>{const t=()=>{r(e.frame);s(e.frames)};e.framesChanged.connect(t);return()=>{e.framesChanged.disconnect(t)}}),[e]);const a=e=>{var t;const s=((t=e.source)===null||t===void 0?void 0:t.path)||"";const i=n.PathExt.basename(n.PathExt.dirname(s));const r=n.PathExt.basename(s);const o=n.PathExt.join(i,r);return`${o}:${e.line}`};return re().createElement("ul",null,t.map((e=>{var t;return re().createElement("li",{key:e.id,onClick:()=>o(e),className:(i===null||i===void 0?void 0:i.id)===e.id?"selected jp-DebuggerCallstackFrame":"jp-DebuggerCallstackFrame"},re().createElement("span",{className:"jp-DebuggerCallstackFrame-name"},e.name),re().createElement("span",{className:"jp-DebuggerCallstackFrame-location",title:(t=e.source)===null||t===void 0?void 0:t.path},a(e)))})))};class pe extends v.Widget{constructor(e){super({node:document.createElement("div")});this.toolbar=new p.Toolbar;this.node.classList.add("jp-stack-panel-header");e=e||C.nullTranslator;const t=e.load("jupyterlab");const s=new v.Widget({node:document.createElement("h2")});s.node.textContent=t.__("Callstack");const i=new v.PanelLayout;i.addWidget(s);i.addWidget(this.toolbar);this.layout=i}}class _e extends v.Panel{constructor(e){super();const{commands:t,model:s}=e;const i=e.translator||C.nullTranslator;const n=new pe(i);const r=new ue(s);n.toolbar.addItem("continue",new p.CommandToolbarButton({commands:t.registry,id:t.continue}));n.toolbar.addItem("terminate",new p.CommandToolbarButton({commands:t.registry,id:t.terminate}));n.toolbar.addItem("step-over",new p.CommandToolbarButton({commands:t.registry,id:t.next}));n.toolbar.addItem("step-in",new p.CommandToolbarButton({commands:t.registry,id:t.stepIn}));n.toolbar.addItem("step-out",new p.CommandToolbarButton({commands:t.registry,id:t.stepOut}));n.toolbar.addItem("evaluate",new p.CommandToolbarButton({commands:t.registry,id:t.evaluate}));this.addWidget(n);this.addWidget(r);this.addClass("jp-DebuggerCallstack")}}class ve extends v.Widget{constructor(e){super();this._model=e.model;this._debuggerService=e.service;this._mimeTypeService=e.editorServices.mimeTypeService;const t=new Be.ReadOnlyEditorFactory({editorServices:e.editorServices});this._editor=t.createNewEditor({content:"",mimeType:"",path:""});this._editor.hide();this._model.currentFrameChanged.connect((async(e,t)=>{if(!t){this._clearEditor();return}void this._showSource(t)}));const s=new v.PanelLayout;s.addWidget(this._editor);this.layout=s;this.addClass("jp-DebuggerSources-body")}dispose(){var e;if(this.isDisposed){return}(e=this._editorHandler)===null||e===void 0?void 0:e.dispose();r.Signal.clearData(this);super.dispose()}_clearEditor(){this._model.currentSource=null;this._editor.hide()}async _showSource(e){var t;const s=(t=e.source)===null||t===void 0?void 0:t.path;const i=await this._debuggerService.getSource({sourceReference:0,path:s});if(!(i===null||i===void 0?void 0:i.content)){this._clearEditor();return}if(this._editorHandler){this._editorHandler.dispose()}const{content:n,mimeType:r}=i;const o=r||this._mimeTypeService.getMimeTypeByFilePath(s!==null&&s!==void 0?s:"");this._editor.model.value.text=n;this._editor.model.mimeType=o;this._editorHandler=new d({debuggerService:this._debuggerService,editor:this._editor.editor,path:s});this._model.currentSource={content:n,mimeType:o,path:s!==null&&s!==void 0?s:""};requestAnimationFrame((()=>{d.showCurrentLine(this._editor.editor,e.line)}));this._editor.show()}}class me extends v.Widget{constructor(e,t){super({node:document.createElement("div")});this.toolbar=new p.Toolbar;this.node.classList.add("jp-stack-panel-header");t=t||C.nullTranslator;const s=t.load("jupyterlab");const i=new v.PanelLayout;this.layout=i;const n=new v.Widget({node:document.createElement("h2")});n.node.textContent=s.__("Source");const r=p.ReactWidget.create(re().createElement(be,{model:e}));i.addWidget(n);i.addWidget(this.toolbar);i.addWidget(r);this.addClass("jp-DebuggerSources-header")}}const be=({model:e})=>re().createElement(p.UseSignal,{signal:e.currentSourceChanged,initialSender:e},(e=>{var t,s;return re().createElement("span",{onClick:()=>e===null||e===void 0?void 0:e.open()},(s=(t=e===null||e===void 0?void 0:e.currentSource)===null||t===void 0?void 0:t.path)!==null&&s!==void 0?s:"")}));class fe extends v.Panel{constructor(e){super();const{model:t,service:s,editorServices:i}=e;const n=e.translator||C.nullTranslator;const r=n.load("jupyterlab");const o=new me(t,n);const a=new ve({service:s,model:t,editorServices:i});o.toolbar.addItem("open",new p.ToolbarButton({icon:O,onClick:()=>t.open(),tooltip:r.__("Open in the Main Area")}));this.addWidget(o);this.addWidget(a)}}class we extends v.Widget{constructor(e){super({node:document.createElement("div")});this.toolbar=new p.Toolbar;this.node.classList.add("jp-stack-panel-header");e=e||C.nullTranslator;const t=e.load("jupyterlab");const s=new v.Widget({node:document.createElement("h2")});s.node.textContent=t.__("Variables");const i=new v.PanelLayout;i.addWidget(s);i.addWidget(this.toolbar);this.layout=i}}const ke=({model:e,tree:t,grid:s,trans:n})=>{const[r,o]=(0,ne.useState)("-");const a=e.scopes;const d=e=>{const i=e.target.value;o(i);t.scope=i;s.scope=i};return re().createElement(i.HTMLSelect,{onChange:d,value:r,"aria-label":n.__("Scope")},a.map((e=>re().createElement("option",{key:e.name,value:e.name},n.__(e.name)))))};class Ce extends p.ReactWidget{constructor(e){super();const{translator:t,model:s,tree:i,grid:n}=e;this._model=s;this._tree=i;this._grid=n;this._trans=(t||C.nullTranslator).load("jupyterlab")}render(){return re().createElement(p.UseSignal,{signal:this._model.changed,initialSender:this._model},(()=>re().createElement(ke,{model:this._model,trans:this._trans,tree:this._tree,grid:this._grid})))}}class ye extends p.ReactWidget{constructor(e){super();this._scope="";this._scopes=[];this._filter=new Set;this._service=e.service;const t=e.model;t.changed.connect(this._updateScopes,this);this.addClass("jp-DebuggerVariables-body")}render(){var e;const t=(e=this._scopes.find((e=>e.name===this._scope)))!==null&&e!==void 0?e:this._scopes[0];return t?re().createElement(Se,{key:t.name,service:this._service,data:t.variables,filter:this._filter}):re().createElement("div",null)}set filter(e){this._filter=e;this.update()}set scope(e){this._scope=e;this.update()}_updateScopes(e){if(S.ArrayExt.shallowEqual(this._scopes,e.scopes)){return}this._scopes=e.scopes;this.update()}}const Se=({data:e,service:t,filter:s})=>{const[i,n]=(0,ne.useState)(e);(0,ne.useEffect)((()=>{n(e)}),[e]);return re().createElement("ul",null,i===null||i===void 0?void 0:i.filter((e=>!(s||new Set).has(e.evaluateName||""))).map((e=>{const i=`${e.name}-${e.evaluateName}-${e.type}-${e.value}-${e.variablesReference}`;return re().createElement(Ee,{key:i,data:e,service:t,filter:s})})))};const Ee=({data:e,service:t,filter:s})=>{const[n]=(0,ne.useState)(e);const[r,o]=(0,ne.useState)();const[a,d]=(0,ne.useState)();const l={color:"var(--jp-mirror-editor-attribute-color)"};const c={color:"var(--jp-mirror-editor-string-color)"};const h=n.variablesReference!==0||n.type==="function";const u=async e=>{if(!h){return}e.stopPropagation();const s=await t.inspectVariable(n.variablesReference);o(!r);d(s)};return re().createElement("li",{onClick:e=>u(e)},re().createElement(i.caretDownEmptyIcon.react,{visibility:h?"visible":"hidden",stylesheet:"menuItem",tag:"span",transform:r?"rotate(0deg)":"rotate(-90deg)"}),re().createElement("span",{style:l},n.name),re().createElement("span",null,": "),re().createElement("span",{style:c},xe(n)),r&&a&&re().createElement(Se,{key:n.name,data:a,service:t,filter:s}))};class Me extends v.Panel{constructor(e){super();const{model:t,service:s,commands:n,themeManager:r}=e;const o=e.translator||C.nullTranslator;const a=o.load("jupyterlab");this._header=new we(o);this._tree=new ye({model:t,service:s});this._table=new Q({model:t,commands:n,themeManager:r});this._table.hide();this._header.toolbar.addItem("scope-switcher",new Ce({translator:o,model:t,tree:this._tree,grid:this._table}));const d=()=>{if(this._table.isHidden){this._tree.hide();this._table.show();this.node.setAttribute("data-jp-table","true");h("table")}else{this._tree.show();this._table.hide();this.node.removeAttribute("data-jp-table");h("tree")}this.update()};const l=new p.ToolbarButton({icon:i.treeViewIcon,className:"jp-TreeView",onClick:d,tooltip:a.__("Tree View")});const c=new p.ToolbarButton({icon:i.tableRowsIcon,className:"jp-TableView",onClick:d,tooltip:a.__("Table View")});const h=e=>{const t="jp-ViewModeSelected";if(e==="tree"){c.removeClass(t);l.addClass(t)}else{l.removeClass(t);c.addClass(t)}};h(this._table.isHidden?"tree":"table");this._header.toolbar.addItem("view-VariableTreeView",l);this._header.toolbar.addItem("view-VariableTableView",c);this.addWidget(this._header);this.addWidget(this._tree);this.addWidget(this._table);this.addClass("jp-DebuggerVariables")}set filter(e){this._tree.filter=e;this._table.filter=e}onResize(e){super.onResize(e);this._resizeBody(e)}_resizeBody(e){const t=e.height-this._header.node.offsetHeight;this._tree.node.style.height=`${t}px`}}const xe=e=>{var t,s;const{type:i,value:n}=e;switch(i){case"int":return parseInt(n,10);case"float":return parseFloat(n);case"bool":return n;case"str":if((s=(t=e.presentationHint)===null||t===void 0?void 0:t.attributes)===null||s===void 0?void 0:s.includes("rawString")){return n.slice(1,n.length-1)}else{return n}default:return i!==null&&i!==void 0?i:n}};class De extends v.Panel{constructor(e){super();this.id="jp-debugger-sidebar";this.title.icon=i.bugIcon;this.addClass("jp-DebuggerSidebar");const{callstackCommands:t,editorServices:s,service:n,themeManager:r}=e;const o=e.translator||C.nullTranslator;const a=n.model;this.variables=new Me({model:a.variables,commands:t.registry,service:n,themeManager:r,translator:o});this.callstack=new _e({commands:t,model:a.callstack,translator:o});this.breakpoints=new he({service:n,model:a.breakpoints,translator:o});this.sources=new fe({model:a.sources,service:n,editorServices:s,translator:o});const d=new De.Header;this.addWidget(d);a.titleChanged.connect(((e,t)=>{d.title.label=t}));this._body=new v.SplitPanel;this._body.orientation="vertical";this._body.addClass("jp-DebuggerSidebar-body");this.addWidget(this._body);this.addItem(this.variables);this.addItem(this.callstack);this.addItem(this.breakpoints);this.addItem(this.sources)}addItem(e){this._body.addWidget(e)}insertItem(e,t){this._body.insertWidget(e,t)}get items(){return this._body.widgets}dispose(){if(this.isDisposed){return}super.dispose()}}(function(e){class t extends v.Widget{constructor(){super({node:Ie.createHeader()});this.title.changed.connect((e=>{this.node.querySelector("h2").textContent=this.title.label}))}}e.Header=t})(De||(De={}));var Ie;(function(e){function t(){const e=document.createElement("div");e.classList.add("jp-stack-panel-header");const t=document.createElement("h2");t.textContent="-";t.classList.add("jp-left-truncated");e.appendChild(t);return e}e.createHeader=t})(Ie||(Ie={}));class Te{constructor(e){var t,s,i;this._config=e.config;this._shell=e.shell;this._notebookTracker=(t=e.notebookTracker)!==null&&t!==void 0?t:null;this._consoleTracker=(s=e.consoleTracker)!==null&&s!==void 0?s:null;this._editorTracker=(i=e.editorTracker)!==null&&i!==void 0?i:null;this._readOnlyEditorTracker=new p.WidgetTracker({namespace:"@jupyterlab/debugger"})}find(e){return[...this._findInConsoles(e),...this._findInEditors(e),...this._findInNotebooks(e),...this._findInReadOnlyEditors(e)]}open(e){const{editorWrapper:t,label:s,caption:n}=e;const r=new p.MainAreaWidget({content:t});r.id=p.DOMUtils.createDomID();r.title.label=s;r.title.closable=true;r.title.caption=n;r.title.icon=i.textEditorIcon;this._shell.add(r,"main");void this._readOnlyEditorTracker.add(r)}_findInNotebooks(e){if(!this._notebookTracker){return[]}const{focus:t,kernel:s,path:i,source:n}=e;const r=[];this._notebookTracker.forEach((e=>{const o=e.sessionContext;if(i!==o.path){return}const a=e.content;if(t){a.mode="command"}const d=e.content.widgets;d.forEach(((i,o)=>{const d=i.model.value.text;const l=this._getCodeId(d,s);if(!l){return}if(n!==l){return}if(t){a.activeCellIndex=o;if(a.activeCell){const e=a.activeCell.inputArea.node;const t=e.getBoundingClientRect();a.scrollToPosition(t.bottom,45)}this._shell.activateById(e.id)}r.push(i.editor)}))}));return r}_findInConsoles(e){if(!this._consoleTracker){return[]}const{focus:t,kernel:s,path:i,source:n}=e;const r=[];this._consoleTracker.forEach((e=>{const o=e.sessionContext;if(i!==o.path){return}const a=e.console.cells;(0,S.each)(a,(i=>{const o=i.model.value.text;const a=this._getCodeId(o,s);if(!a){return}if(n!==a){return}r.push(i.editor);if(t){this._shell.activateById(e.id)}}))}));return r}_findInEditors(e){if(!this._editorTracker){return[]}const{focus:t,kernel:s,path:i,source:n}=e;const r=[];this._editorTracker.forEach((e=>{const o=e.content;if(i!==o.context.path){return}const a=o.editor;if(!a){return}const d=a.model.value.text;const l=this._getCodeId(d,s);if(!l){return}if(n!==l){return}r.push(a);if(t){this._shell.activateById(e.id)}}));return r}_findInReadOnlyEditors(e){const{focus:t,kernel:s,source:i}=e;const n=[];this._readOnlyEditorTracker.forEach((e=>{var r;const o=(r=e.content)===null||r===void 0?void 0:r.editor;if(!o){return}const a=o.model.value.text;const d=this._getCodeId(a,s);if(!d){return}if(e.title.caption!==i&&i!==d){return}n.push(o);if(t){this._shell.activateById(e.id)}}));return n}_getCodeId(e,t){try{return this._config.getCodeId(e,t)}catch(s){return""}}}var Be;(function(e){class t extends g{}e.Config=t;class s extends d{}e.EditorHandler=s;class n extends B{}e.Handler=n;class r extends U{}e.Model=r;class o extends k{}e.ReadOnlyEditorFactory=o;class a extends te{}e.Service=a;class l extends ie{}e.Session=l;class c extends De{}e.Sidebar=c;class h extends Te{}e.Sources=h;class u extends Q{}e.VariablesGrid=u;let p;(function(e){e.debugContinue="debugger:continue";e.terminate="debugger:terminate";e.next="debugger:next";e.stepIn="debugger:stepIn";e.stepOut="debugger:stepOut";e.inspectVariable="debugger:inspect-variable";e.evaluate="debugger:evaluate";e.restartDebug="debugger:restart-debug"})(p=e.CommandIDs||(e.CommandIDs={}));let _;(function(e){e.closeAllIcon=F;e.evaluateIcon=i.codeIcon;e.continueIcon=i.runIcon;e.stepIntoIcon=P;e.stepOutIcon=q;e.stepOverIcon=N;e.terminateIcon=i.stopIcon;e.variableIcon=A;e.viewBreakpointIcon=O})(_=e.Icons||(e.Icons={}));let v;(function(e){e.getCode=m.getCode})(v=e.Dialogs||(e.Dialogs={}))})(Be||(Be={}));const je=new se.Token("@jupyterlab/debugger:IDebugger");const Le=new se.Token("@jupyterlab/debugger:IDebuggerConfig");const He=new se.Token("@jupyterlab/debugger:IDebuggerSources");const Ve=new se.Token("@jupyterlab/debugger:IDebuggerSidebar")}}]);