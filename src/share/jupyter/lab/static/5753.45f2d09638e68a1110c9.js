(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[5753],{75753:(t,e,o)=>{"use strict";o.r(e);o.d(e,{FileEditor:()=>v,FileEditorCodeWrapper:()=>f,FileEditorFactory:()=>y,IEditorTracker:()=>h,TabSpaceStatus:()=>d});var s=o(26825);var n=o(10314);var i=o(1612);var r=o(2411);var c=o.n(r);function a(t){const e=t.translator||i.nullTranslator;const o=e.load("jupyterlab");const s=t.isSpaces?o.__("Spaces"):o.__("Tab Size");return c().createElement(n.TextItem,{onClick:t.handleClick,source:`${s}: ${t.tabSpace}`,title:o.__("Change Tab indentationâ€¦")})}class d extends s.VDomRenderer{constructor(t){super(new d.Model);this._popup=null;this._menu=t.menu;this.translator=t.translator||i.nullTranslator;this.addClass(n.interactiveItem)}render(){if(!this.model||!this.model.config){return null}else{return c().createElement(a,{isSpaces:this.model.config.insertSpaces,tabSpace:this.model.config.tabSize,handleClick:()=>this._handleClick(),translator:this.translator})}}_handleClick(){const t=this._menu;if(this._popup){this._popup.dispose()}t.aboutToClose.connect(this._menuClosed,this);this._popup=(0,n.showPopup)({body:t,anchor:this,align:"right"})}_menuClosed(){this.removeClass(n.clickedItem)}}(function(t){class e extends s.VDomModel{constructor(){super(...arguments);this._config=null}get config(){return this._config}set config(t){const e=this._config;this._config=t;this._triggerChange(e,this._config)}_triggerChange(t,e){const o=t&&t.insertSpaces;const s=t&&t.tabSize;const n=e&&e.insertSpaces;const i=e&&e.tabSize;if(o!==n||s!==i){this.stateChanged.emit(void 0)}}}t.Model=e})(d||(d={}));var l=o(9727);const h=new l.Token("@jupyterlab/fileeditor:IEditorTracker");var u=o(77616);var p=o(56052);var m=o(92481);var _=o(61389);const g="jpCodeRunner";const C="jpUndoer";class f extends u.CodeEditorWrapper{constructor(t){super({factory:t.factory,model:t.context.model});this._ready=new l.PromiseDelegate;const e=this._context=t.context;const o=this.editor;this.addClass("jp-FileEditorCodeWrapper");this.node.dataset[g]="true";this.node.dataset[C]="true";o.model.value.text=e.model.toString();void e.ready.then((()=>{this._onContextReady()}));if(e.model.modelDB.isCollaborative){const t=e.model.modelDB;void t.connected.then((()=>{const e=t.collaborators;if(!e){return}const o=e.localCollaborator;this.editor.uuid=o.sessionId;this.editor.selectionStyle=Object.assign(Object.assign({},u.CodeEditor.defaultSelectionStyle),{color:o.color});e.changed.connect(this._onCollaboratorsChanged,this);this._onCollaboratorsChanged()}))}}get context(){return this._context}get ready(){return this._ready.promise}_onContextReady(){if(this.isDisposed){return}const t=this._context.model;const e=this.editor;const o=e.model;o.value.text=t.toString();e.clearHistory();t.contentChanged.connect(this._onContentChanged,this);this._ready.resolve(undefined)}_onContentChanged(){const t=this.editor.model;const e=t.value.text;const o=this._context.model.toString();if(e!==o){t.value.text=o}}_onCollaboratorsChanged(){const t=this._context.model.modelDB.collaborators;if(!t){return}for(const e of this.editor.model.selections.keys()){if(!t.has(e)){this.editor.model.selections.delete(e)}}}}class v extends _.Widget{constructor(t){super();this.addClass("jp-FileEditor");const e=this._context=t.context;this._mimeTypeService=t.mimeTypeService;const o=this.editorWidget=new f(t);this.editor=o.editor;this.model=o.model;e.pathChanged.connect(this._onPathChanged,this);this._onPathChanged();const s=this.layout=new _.StackedLayout;s.addWidget(o)}get context(){return this.editorWidget.context}get ready(){return this.editorWidget.ready}handleEvent(t){if(!this.model){return}switch(t.type){case"mousedown":this._ensureFocus();break;default:break}}onAfterAttach(t){super.onAfterAttach(t);const e=this.node;e.addEventListener("mousedown",this)}onBeforeDetach(t){const e=this.node;e.removeEventListener("mousedown",this)}onActivateRequest(t){this._ensureFocus()}_ensureFocus(){if(!this.editor.hasFocus()){this.editor.focus()}}_onPathChanged(){const t=this.editor;const e=this._context.localPath;t.model.mimeType=this._mimeTypeService.getMimeTypeByFilePath(e)}}class y extends p.ABCWidgetFactory{constructor(t){super(t.factoryOptions);this._services=t.editorServices}createNewWidget(t){const e=this._services.factoryService.newDocumentEditor;const o=t=>e(t);const s=new v({factory:o,context:t,mimeTypeService:this._services.mimeTypeService});s.title.icon=m.textEditorIcon;const n=new p.DocumentWidget({content:s,context:t});return n}}}}]);